(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},12426,e=>{"use strict";let t=(0,e.i(75254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],12426)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},25720,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var l=e.i(98925),r=e.i(59141),s=e.i(18566),n=e.i(31278),o=e.i(56909),i=e.i(87316),d=e.i(12426),c=e.i(75254);let p=(0,c.default)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]);var x=e.i(71689);e.i(61086);var u=e.i(27215),h=e.i(69074),m=e.i(37727);let f=(0,c.default)("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]);var g=e.i(75157);function b({label:e,folder:l,onUploadComplete:s,initialUrl:o,accept:i,helperText:d}){let[c,p]=(0,a.useState)(0),[x,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)(o||null),[j,w]=(0,a.useState)(!1),N=(0,a.useRef)(null),k=async e=>{if(!e)return;let t=`${Date.now()}_${e.name.replace(/[^a-zA-Z0-9.]/g,"_")}`,a=(0,u.ref)(r.storage,`${l}/${t}`);b(!0),p(0);try{let t=(0,u.uploadBytesResumable)(a,e);t.on("state_changed",e=>{let t=e.bytesTransferred/e.totalBytes*100;p(t)},e=>{console.error("Upload error:",e),alert("Upload failed. Please try again."),b(!1)},async()=>{let a=await (0,u.getDownloadURL)(t.snapshot.ref);v(a),s(a,{size:e.size,type:e.type}),b(!1)})}catch(e){console.error("Error starting upload:",e),b(!1)}},U=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?w(!0):"dragleave"===e.type&&w(!1)};return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300 flex items-center gap-2",children:e}),(0,t.jsxs)("div",{className:(0,g.cn)("relative group cursor-pointer transition-all duration-200 ease-in-out","border-2 border-dashed rounded-xl p-4 flex flex-col items-center justify-center text-center",j?"border-brand-pink bg-brand-pink/5":"border-white/10 hover:border-white/20 hover:bg-white/5",y?"h-64":"h-32"),onDragEnter:U,onDragLeave:U,onDragOver:U,onDrop:e=>{e.preventDefault(),e.stopPropagation(),w(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&k(e.dataTransfer.files[0])},onClick:()=>N.current?.click(),children:[(0,t.jsx)("input",{ref:N,type:"file",className:"hidden",accept:i,onChange:e=>{e.preventDefault(),e.target.files&&e.target.files[0]&&k(e.target.files[0])}}),x?(0,t.jsxs)("div",{className:"w-full max-w-xs space-y-2",children:[(0,t.jsx)(n.Loader2,{className:"w-8 h-8 animate-spin text-brand-pink mx-auto"}),(0,t.jsx)("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-brand-pink transition-all duration-300",style:{width:`${c}%`}})}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:["Uploading... ",Math.round(c),"%"]})]}):y?(0,t.jsxs)("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:[i?.startsWith("image/")?(0,t.jsx)("img",{src:y,alt:"Preview",className:"w-full h-full object-contain rounded-lg"}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 text-brand-green",children:[(0,t.jsx)(f,{className:"w-12 h-12"}),(0,t.jsx)("span",{className:"text-sm font-mono truncate max-w-[200px]",children:y.split("/").pop()})]}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),v(null),s(""),N.current&&(N.current.value="")},className:"absolute -top-2 -right-2 p-1.5 bg-red-500 rounded-full text-white shadow-lg hover:bg-red-600 transition-transform hover:scale-110",title:"Remove file",children:(0,t.jsx)(m.X,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-lg",children:(0,t.jsx)("p",{className:"text-white font-bold text-sm",children:"Click to Replace"})})]}):(0,t.jsxs)("div",{className:"space-y-2 pointer-events-none",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center mx-auto",children:(0,t.jsx)(h.Upload,{className:"w-5 h-5 text-gray-400"})}),(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,t.jsx)("span",{className:"text-brand-pink font-bold",children:"Click to upload"})," or drag and drop"]}),d&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:d})]})]})]})}var y=e.i(22016);function v(){let e=(0,s.useRouter)(),c=(0,s.useSearchParams)().get("id"),u=!!c,[h,m]=(0,a.useState)(!1),[f,g]=(0,a.useState)(u),v=new Date,j=new Date;j.setDate(j.getDate()+7);let w=e=>e.toISOString().slice(0,16),[N,k]=(0,a.useState)({title:"",description:"",imageUrl:"",contentUrl:"",unlockCost:50,validFrom:w(v),validUntil:w(j),type:"content",ctaText:"",actionUrl:"",accentColor:"#ec4899",fileMetadata:null});(0,a.useEffect)(()=>{c&&t();async function t(){try{let t=(0,l.doc)(r.db,"drops",c),a=await (0,l.getDoc)(t);if(a.exists()){let e=a.data();k({title:e.title,description:e.description,imageUrl:e.imageUrl,contentUrl:e.contentUrl,unlockCost:e.unlockCost,validFrom:w(new Date(e.validFrom)),validUntil:w(new Date(e.validUntil)),type:e.type||"content",ctaText:e.ctaText||"",actionUrl:e.actionUrl||"",accentColor:e.accentColor||"#ec4899",fileMetadata:e.fileMetadata||null})}else alert("Drop not found!"),e.push("/admin/drops")}catch(e){console.error("Error fetching drop:",e)}finally{g(!1)}}},[c,e]);let U=e=>{let{name:t,value:a}=e.target;k(e=>({...e,[t]:a}))},C=e=>(t,a)=>{k(l=>{let r={[e]:t};return"contentUrl"===e&&a&&(r.fileMetadata=a),{...l,...r}})},D=async t=>{t.preventDefault(),m(!0);try{let t=new Date(N.validFrom).getTime(),a=new Date(N.validUntil).getTime();if(isNaN(t)||isNaN(a))throw Error("Invalid dates");let s={title:N.title,description:N.description,imageUrl:N.imageUrl,contentUrl:N.contentUrl,unlockCost:Number(N.unlockCost),validFrom:t,validUntil:a,status:Date.now()<a?"active":"expired",type:N.type,ctaText:N.ctaText,actionUrl:N.actionUrl,accentColor:N.accentColor,fileMetadata:N.fileMetadata};u?await (0,l.updateDoc)((0,l.doc)(r.db,"drops",c),s):await (0,l.addDoc)((0,l.collection)(r.db,"drops"),{...s,totalUnlocks:0}),e.push("/admin/drops")}catch(e){console.error("Error saving drop:",e),alert("Failed to save drop. Check console.")}finally{m(!1)}};return f?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)(n.Loader2,{className:"w-8 h-8 animate-spin text-white"})}):(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("header",{className:"mb-8",children:[(0,t.jsxs)(y.default,{href:"/admin/drops",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white mb-4 transition-colors",children:[(0,t.jsx)(x.ArrowLeft,{className:"w-4 h-4"})," Back to Drops"]}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:u?"Edit Drop":"Create New Drop"}),(0,t.jsx)("p",{className:"text-gray-400",children:u?"Update the details for this content drop.":"Configure a new content drop for your fans."})]}),(0,t.jsxs)("form",{onSubmit:D,className:"glass-panel p-8 rounded-3xl space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-bold text-gray-300 flex items-center gap-2",children:[(0,t.jsx)(p,{className:"w-4 h-4"})," Drop Title"]}),(0,t.jsx)("input",{type:"text",name:"title",required:!0,value:N.title,onChange:U,placeholder:"e.g. Neon Lollipops Pack",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white placeholder:text-gray-600 focus:outline-none focus:border-brand-pink/50 focus:ring-1 focus:ring-brand-pink/50 transition-all"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300",children:"Description"}),(0,t.jsx)("textarea",{name:"description",required:!0,value:N.description,onChange:U,placeholder:"Describe what's inside...",rows:3,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white placeholder:text-gray-600 focus:outline-none focus:border-brand-pink/50 focus:ring-1 focus:ring-brand-pink/50 transition-all resize-none"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"col-span-full space-y-6 bg-white/5 p-6 rounded-2xl border border-white/5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300",children:"Drop Type"}),(0,t.jsxs)("select",{name:"type",value:N.type,onChange:U,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-pink/50 transition-all",children:[(0,t.jsx)("option",{value:"content",children:"Content Drop (Standard)"}),(0,t.jsx)("option",{value:"promo",children:"Promo / Ad"}),(0,t.jsx)("option",{value:"external",children:"External Link"})]})]}),"content"!==N.type&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 animate-in fade-in slide-in-from-top-4 duration-300",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300",children:"Call to Action (Button)"}),(0,t.jsx)("input",{type:"text",name:"ctaText",value:N.ctaText,onChange:U,placeholder:"e.g. Visit Shop",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-pink/50 transition-all"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300",children:"Action URL"}),(0,t.jsx)("input",{type:"url",name:"actionUrl",value:N.actionUrl,onChange:U,placeholder:"https://...",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-pink/50 transition-all"})]}),(0,t.jsxs)("div",{className:"space-y-2 col-span-full",children:[(0,t.jsx)("label",{className:"text-sm font-bold text-gray-300",children:"Accent Color"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"color",name:"accentColor",value:N.accentColor,onChange:U,className:"h-12 w-12 rounded-lg cursor-pointer bg-transparent border-none"}),(0,t.jsx)("input",{type:"text",name:"accentColor",value:N.accentColor,onChange:U,className:"flex-1 bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white font-mono"})]})]})]})]}),(0,t.jsx)(b,{label:"Drop Image (Cover)",folder:"drops/images",accept:"image/*",helperText:"Recommend 1:1 aspect ratio",initialUrl:N.imageUrl,onUploadComplete:C("imageUrl")}),(0,t.jsx)(b,{label:"Content (The Drop)",folder:"drops/content",helperText:"Zip, Audio, Video, etc.",initialUrl:N.contentUrl,onUploadComplete:C("contentUrl")})]}),(0,t.jsx)("input",{type:"hidden",name:"imageUrl",required:!0,value:N.imageUrl}),(0,t.jsx)("input",{type:"hidden",name:"contentUrl",required:!0,value:N.contentUrl}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-bold text-gray-300 flex items-center gap-2",children:[(0,t.jsx)(d.DollarSign,{className:"w-4 h-4"})," Cost (Drops)"]}),(0,t.jsx)("input",{type:"number",name:"unlockCost",required:!0,min:"0",value:N.unlockCost,onChange:U,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-yellow/50 transition-all"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-bold text-gray-300 flex items-center gap-2",children:[(0,t.jsx)(i.Calendar,{className:"w-4 h-4"})," Valid From"]}),(0,t.jsx)("input",{type:"datetime-local",name:"validFrom",required:!0,value:N.validFrom,onChange:U,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-cyan/50 transition-all [color-scheme:dark]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-bold text-gray-300 flex items-center gap-2",children:[(0,t.jsx)(i.Calendar,{className:"w-4 h-4"})," Valid Until"]}),(0,t.jsx)("input",{type:"datetime-local",name:"validUntil",required:!0,value:N.validUntil,onChange:U,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-cyan/50 transition-all [color-scheme:dark]"})]})]}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsxs)("button",{type:"submit",disabled:h,className:"w-full py-4 rounded-xl bg-gradient-to-r from-brand-pink to-brand-purple font-bold text-white shadow-lg shadow-brand-pink/20 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[h?(0,t.jsx)(n.Loader2,{className:"w-5 h-5 animate-spin"}):(0,t.jsx)(o.Save,{className:"w-5 h-5"}),h?"Saving Drop...":u?"Update Drop":"Create Drop"]})})]})]})}function j(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"text-white p-8",children:"Loading..."}),children:(0,t.jsx)(v,{})})}e.s(["default",()=>j],25720)}]);